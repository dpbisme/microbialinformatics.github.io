--- 
title       : Microbial Informatics
subtitle    : Lecture 07
date        : September 24, 2014
author      : Patrick D. Schloss, PhD (microbialinformatics.github.io)
job         : Department of Microbiology & Immunology
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : standalone    # {selfcontained, standalone, draft}
knit        : slidify::knit2slides

--- 

## Announcements
* When you upload your assignments, upload the README.Rmd and README.md files generated by RStudio/knitr
* Will use first hour tomorrow to cover subject material and second hour to help people with assignment
* Start thinking about your project:
    * Emphasis on data analysis
    * Due 10/24/2104 (friday)
    * Feel free to come to office hours to discuss project ideas
    * I have some ideas for microbial ecology analysis projects

--- 

## Review
* Everything in R is some form of a vector - even output
* R has a rich set of descriptive statistics that can be used to simplify datasets



---

## Learning objectives
* Histograms
* Box plots
* Bar plots
* Strip charts

---

## Histograms


```r
metadata <- read.table(file = "wild.metadata.txt", header = T)
rownames(metadata) <- metadata$Group
metadata <- metadata[, -1]
```

---
	
## Data visualization

* This is a huge area of explorataion
* R is tremendously powerful for generating plots and data visualizaiton tools
* Can generally tell someone used MS Excel by how bad the plots look
* Can certainly generate crap in R, but upside is greater
* Numerous packages available, but we will focus on base package until the end of the semester:
  - Lattice
  - ggplot2
  - rgl

---

## Histograms

* Good for summarizing continuous data where you want to break it into discrete classes
* What do these two sets of commands do?


```r
par(mfrow = c(2, 1))  # make two plotting windows
hist(metadata$Weight[metadata$Sex == "F"])
hist(metadata$Weight[metadata$Sex == "M"])
par(mfrow = c(1, 1))  # return to one plotting window

par(mfrow = c(2, 1))
hist(metadata$Weight[metadata$Sex == "F"], breaks = 10, ylim = c(0, 20), xlim = c(0, 
    30))
hist(metadata$Weight[metadata$Sex == "M"], breaks = 10, ylim = c(0, 20), xlim = c(0, 
    30), add = T)
par(mfrow = c(1, 1))
```

---

## Merging plots with `add=T`


```r
hist(metadata$Weight[metadata$Sex == "F"], breaks = 10, ylim = c(0, 20), xlim = c(0, 
    30), col = "pink")
hist(metadata$Weight[metadata$Sex == "M"], breaks = 10, col = "blue", add = T)
```

---

## Universal options

* Axis labels


```r
hist(metadata$Weight, xlab = "Weights of Peromyscus spp.")
```

* Plot title


```r
hist(metadata$Weight, main = "Distribution of Peromyscus spp. weights")
```

* Putting it together


```r
hist(metadata$Weight, main = "Distribution of Peromyscus spp. weights", xlab = "Weights of Peromyscus spp.")
box()
```

---

## What is the output from `hist`?


```r
m.hist <- hist(metadata$Weight[metadata$Sex == "F"], breaks = 10, ylim = c(0, 
    20), xlim = c(0, 30), col = "pink")
f.hist <- hist(metadata$Weight[metadata$Sex == "M"], breaks = 10, col = "blue", 
    add = T)
```

---

##	Boxplots
*	Multiple histograms gets pretty cludgey
*	Box plots allows you to plot out the results of the summary command
	

```r
boxplot(metadata$Weight)  #\tmin, 25%tile, Median, 75%tile, max, outliers
boxplot(metadata$Weight[metadata$Sex == "F"], metadata$Weight[metadata$Sex == 
    "M"])
boxplot(metadata$Weight ~ metadata$Sex)
```

---

## Barplots

```
avg.weights <- aggregate(Weight~Sex, data=metadata, mean)
barplot(height=avg.weights$Weight, names.arg=avg.weights$Sex)

counts <- table(metadata$Sex,metadata$SP)
counts
barplot(counts)
barplot(counts, beside=T)
```

---

##	Stripcharts
*	Perhaps we don't have a ton of points and we want to see all of the data (think of animal experiments)


```r
stripchart(metadata$Weight)
stripchart(metadata$Weight, method = "jitter")
stripchart(metadata$Weight ~ metadata$Sex, method = "jitter")
stripchart(metadata$Weight ~ metadata$Sex, method = "jitter", vertical = T)
stripchart(metadata$Weight ~ metadata$Sex, method = "jitter", jitter = 0.02, 
    vertical = T)
stripchart(metadata$Weight ~ metadata$Sex, method = "jitter", jitter = 0.02, 
    vertical = T, pch = 19)
```

---

## What's happening here?


```r
stripchart(metadata$Weight ~ metadata$Sex, method = "jitter", jitter = 0.02, 
    vertical = T, pch = c(18, 19), col = c("red", "blue"))
```

---

##	Dot plots
*	The above methods generally involve plotting a numerical value against a categorical value
*	We'd also like to plot numerical variables against each other


```r
plot(metadata$Weight)  #\twhat is this using as an x-axis?
plot(metadata$Weight, metadata$Ear)  #\twhat is this using as an x-axis?\t\t\t
plot(metadata$Ear ~ metadata$Weight)  #\twhat is this using as an x-axis?
```

---

## Fun with plots
* Be sure to see `?plot` and ??

```r
plot(metadata$Ear ~ metadata$Weight, col = "blue", pch = 18)
plot(metadata$Ear ~ metadata$Weight, col = "blue", pch = 20)
plot(metadata$Ear ~ metadata$Weight, col = "blue", pch = 20, cex = 2)
```

---

## `points`


```r
plot(metadata[metadata$Sex == "M", "Ear"] ~ metadata[metadata$Sex == "M", "Weight"], 
    col = "blue", pch = 18)
points(metadata[metadata$Sex == "F", "Ear"] ~ metadata[metadata$Sex == "F", 
    "Weight"], col = "pink", pch = 20)
```

---

## A different kind of histogram


```r
plot(m.hist$density ~ m.hist$mids, type = "h", col = "blue", ylim = c(0, 0.2))
points(f.hist$density ~ f.hist$mids, type = "h", col = "red")

plot(m.hist$density ~ m.hist$mids, type = "l", col = "blue", ylim = c(0, 0.2))
points(f.hist$density ~ f.hist$mids, type = "l", col = "red")
```

---

## legends


```r
legend(x = 20, y = 0.18, legend = c("Female", "Male"), col = c("red", "blue"), 
    lty = 1, lwd = 2)
```


```r
location <- locator(1)
legend(location, legend = c("Female", "Male"), col = c("red", "blue"), lty = 1, 
    lwd = 2)
location
```

---

## For Friday  
* Assignment due Friday
* Read ***Introduction to Statistics with R*** (Chapter 8)

--- .segue .dark

## Questions?

